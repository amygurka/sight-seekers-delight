!function e(t,a,i){function o(s,n){if(!a[s]){if(!t[s]){var d="function"==typeof require&&require;if(!n&&d)return d(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=a[s]={exports:{}};t[s][0].call(l.exports,function(e){var a=t[s][1][e];return o(a?a:e)},l,l.exports,e,t,a,i)}return a[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(e){var t=e("./servmask/util"),a=(e("./servmask/report"),e("./servmask/maintenance"),e("./servmask/feedback"),e("./servmask/import_controller"));jQuery(document).ready(function(e){"use strict";var i=this,o=new a("file");e(document).on("dragover","#ai1wm-drag-drop-area",function(t){t.preventDefault(),e("#ai1wm-plupload-upload-ui").addClass("ai1wm-drag-over")}),e(document).on("dragleave","#ai1wm-drag-drop-area",function(t){t.preventDefault(),e("#ai1wm-plupload-upload-ui").removeClass("ai1wm-drag-over")}),e(document).on("drop","#ai1wm-drag-drop-area",function(t){t.preventDefault(),e("#ai1wm-plupload-upload-ui").removeClass("ai1wm-drag-over"),i.storage=o.storage(),i.file=t.originalEvent.dataTransfer.files.item(0),o.uploadFile(i.storage,i.file)}),e(document).on("change","#ai1wm-import-file",function(e){e.preventDefault(),i.storage=o.storage(),i.file=e.originalEvent.dataTransfer.files.item(0),o.uploadFile(i.storage,i.file),this.value=null}),e(document).on("click","#ai1wm-import-stop",function(e){e.preventDefault(),o.stop()}),e(document).on("click","#ai1wm-import-close",function(e){e.preventDefault(),o.close()}),e(document).on("click","#ai1wm-import-confirm",function(e){e.preventDefault(),o.import({method:"enumerate",storage:i.storage,archive:i.file.name})}),e(document).on("click",".ai1wm-expandable > div.ai1wm-button-main",function(){e(this).parent().toggleClass("ai1wm-open")});var r=t.getURLParameter("restore-file");r&&o.import({method:"start",archive:r})})},{"./servmask/feedback":2,"./servmask/import_controller":3,"./servmask/maintenance":5,"./servmask/report":6,"./servmask/util":9}],2:[function(){jQuery(document).ready(function(e){"use strict";e(".ai1wm-feedback-type").attr("checked",!1),e("#ai1wm-feedback-type-link-1").click(function(t){var a=e("#ai1wm-feedback-type-1");a.is(":checked")?(a.attr("checked",!1),t.preventDefault()):a.attr("checked",!0)}),e("#ai1wm-feedback-type-2").click(function(){e("#ai1wm-feedback-type-1, #ai1wm-feedback-type-3").closest("li").hide(),e(".ai1wm-feedback-form").find(".ai1wm-feedback-message").attr("placeholder","Leave plugin developers any feedback here"),e(".ai1wm-feedback-form").fadeIn()}),e("#ai1wm-feedback-type-3").click(function(){e("#ai1wm-feedback-type-1, #ai1wm-feedback-type-2").closest("li").hide(),e(".ai1wm-feedback-form").find(".ai1wm-feedback-message").attr("placeholder","How may we help you?"),e(".ai1wm-feedback-form").fadeIn()}),e("#ai1wm-feedback-cancel").click(function(t){e(".ai1wm-feedback-form").fadeOut(function(){e(".ai1wm-feedback-type").attr("checked",!1).closest("li").show()}),t.preventDefault()}),e("#ai1wm-feedback-submit").click(function(){var t=ai1wm_feedback.ajax.url,a=e(".ai1wm-feedback-type:checked").val(),i=e(".ai1wm-feedback-email").val(),o=e(".ai1wm-feedback-message").val(),r=e(".ai1wm-feedback-terms").is(":checked");e.ajax({type:"POST",url:t,data:{type:a,email:i,message:o,terms:+r},success:function(t){var a=t.errors;if(a.length>0){e(".ai1wm-feedback .ai1wm-message").remove();var i=e("<div />").addClass("ai1wm-message ai1wm-error-message");e.each(a,function(e,t){i.append("<p>"+t+"</p>")}),e(".ai1wm-feedback").prepend(i)}else{var o=e("<div />").addClass("ai1wm-message ai1wm-success-message").append("<p>Thanks for submitting your feedback!</p>");e(".ai1wm-feedback").html(o)}},dataType:"json",async:!1})})})},{}],3:[function(e,t){(function(a){var i=e("./import_modal"),o=e("./uploader"),r=e("./util"),s=jQuery,n=function(e){this.modal=new i,this.retry=3,ai1wm_uploader.onFileAdded=this.onFileAdded.bind(this),ai1wm_uploader.onChunkUploaded=this.onChunkUploaded.bind(this),ai1wm_uploader.onFileUploaded=this.onFileUploaded.bind(this),ai1wm_uploader.onError=this.onError.bind(this),this.uploader=new o(ai1wm_uploader),this.config=s.extend({},{provider:e,secret_key:ai1wm_import.secret_key})};n.prototype.import=function(e){void 0!==typeof e.storage&&s.extend(this.config,{storage:e.storage}),void 0!==typeof e.archive&&s.extend(this.config,{archive:e.archive}),this.request(e)},n.prototype.request=function(e){var t=this,e=s.extend(e,this.config);s.ajax({url:ai1wm_import.ajax.url,data:e,cache:!1,method:"GET",dataType:"json"}).done(function(e){e&&t.request(e),t.status(e)}).fail(function(){t.attemptToRetry(function(){t.request(e)})})},n.prototype.attemptToRetry=function(e,t){t=t||"All in One WP Migration failed reaching your webserver. Would you like to retry?",this.retry>0?(this.retry--,e()):confirm(t)&&(this.retry=3,e())},n.prototype.status=function(){var e=this;s.ajax({url:ai1wm_import.status.url+"/status.php",cache:!1,method:"GET",dataType:"json"}).done(function(t){e.display(t)}).fail(function(){e.attemptToRetry(function(){e.status()})})},n.prototype.stop=function(){var e=this,t=s.extend({method:"clean"},this.config);this.uploader.stop(),s.ajax({url:ai1wm_import.ajax.url,data:t,cache:!1,async:!1,method:"GET"}).done(function(){e.modal.hide()}).fail(function(){e.attemptToRetry(function(){e.stop(t)})})},n.prototype.close=function(){this.modal.hide()},n.prototype.storage=function(){return r.random(12)},n.prototype.uploadFile=function(e,t){this.uploader.addFile(e,t)},n.prototype.onFileAdded=function(){this.uploader.start(),this.display({type:"progress",percent:0})},n.prototype.onChunkUploaded=function(e){this.display({type:"progress",percent:e})},n.prototype.onFileUploaded=function(e,t){this.import({method:"start",storage:e,archive:t})},n.prototype.onError=function(){alert("Upload error")},n.prototype.display=function(e){var t=this;switch(t.modal.reset(),t.modal.show(),e.type){case"error":t.modal._title.html(e.title),t.modal._title.addClass("ai1wm-title-red"),t.modal._title.show(),t.modal._message.html(e.message),t.modal._message.css("text-align","left"),t.modal._message.show(),t.modal._close.show();break;case"confirm":t.modal._warning.show(),t.modal._message.html(e.message),t.modal._message.show(),t.modal._confirm.show();break;case"progress":t.modal._progressBar.show(),t.modal._progressBarPercent.text(e.percent+"%"),t.modal._progressBarMeter.width(e.percent+"%"),t.modal._stop.show();break;case"finish":t.modal._title.html(e.title),t.modal._title.addClass("ai1wm-title-green"),t.modal._title.show(),t.modal._message.html(e.message),t.modal._message.show(),t.modal._close.show();break;default:t.modal._loader.show(),t.modal._message.html(e.message),t.modal._message.show(),t.modal._stop.show(),t.modal._stop.attr("disabled","disabled")}},t.exports=n,a.window.Ai1wmImportController=n}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./import_modal":4,"./uploader":8,"./util":9}],4:[function(e,t){var a=jQuery,i=function(){this._overlay=a('<div class="ai1wm-overlay"></div>'),this._modal=a('<div class="ai1wm-modal-container"></div>'),this._section=a("<section></section>"),this._header=a("<h1></h1>"),this._message=a("<p></p>").hide(),this._action=a("<div></div>"),this._title=a("<span></span>").hide(),this._loader=a('<span class="ai1wm-loader"></span>').hide(),this._warning=a('<span class="ai1wm-icon-notification"></span>').hide(),this._progressBar=a('<span class="ai1wm-progress-bar"></span>').hide(),this._progressBarMeter=a('<span class="ai1wm-progress-bar-meter"></span>'),this._progressBarPercent=a('<span class="ai1wm-progress-bar-percent">0%</span>'),this._stop=a('<button id="ai1wm-import-stop" class="ai1wm-button-red"><i class="ai1wm-icon-notification"></i> Stop import</button>').hide(),this._close=a('<button id="ai1wm-import-close" class="ai1wm-button-red">Close</button>').hide(),this._confirm=a('<button id="ai1wm-import-confirm" class="ai1wm-button-green">Continue</button>').hide(),this._progressBar.append(this._progressBarMeter).append(this._progressBarPercent),this._action.append(this._stop).append(this._close).append(this._confirm),this._header.append(this._title).append(this._loader).append(this._warning).append(this._progressBar),this._section.append(this._header).append(this._message),this._modal.append(this._section).append(this._action),a("body").append(this._overlay).append(this._modal)};i.prototype.show=function(){return this._overlay.show(),this._modal.show(),this},i.prototype.hide=function(){return this._modal.hide(),this._overlay.hide(),this},i.prototype.remove=function(){return this.hide(),this._modal.remove(),this._overlay.remove(),this},i.prototype.reset=function(){return this._title.hide(),this._loader.hide(),this._warning.hide(),this._progressBar.hide(),this._message.hide(),this._stop.hide(),this._stop.removeAttr("disabled"),this._close.hide(),this._confirm.hide(),this},t.exports=i},{}],5:[function(){jQuery(document).ready(function(e){"use strict";e("#ai1wm-maintenance-off").click(function(t){var a=ai1wm_maintenance.ajax.url,i=e(this);e.ajax({type:"POST",url:a,success:function(){i.closest(".ai1wm-message-warning").remove()}}),t.preventDefault()})})},{}],6:[function(){jQuery(document).ready(function(e){"use strict";e("#ai1wm-report-problem-button").click(function(t){e(this).next(".ai1wm-report-problem-dialog").toggleClass("ai1wm-report-active"),t.preventDefault()}),e("#ai1wm-report-cancel").click(function(t){e(this).closest(".ai1wm-report-problem-dialog").removeClass("ai1wm-report-active"),t.preventDefault()}),e("#ai1wm-report-submit").click(function(){var t=ai1wm_report.ajax.url,a=e(".ai1wm-report-email").val(),i=e(".ai1wm-report-message").val(),o=e(".ai1wm-report-terms").is(":checked");e.ajax({type:"POST",url:t,data:{email:a,message:i,terms:+o},success:function(t){var a=t.errors;if(a.length>0){e(".ai1wm-report-problem-dialog .ai1wm-message").remove();var i=e("<div />").addClass("ai1wm-message ai1wm-error-message");e.each(a,function(e,t){i.append("<p>"+t+"</p>")}),e(".ai1wm-report-problem-dialog").prepend(i)}else{var o=e("<div />").addClass("ai1wm-message ai1wm-success-message").append("<p>Thanks for submitting your request!</p>");e(".ai1wm-report-problem-dialog").html(o),setTimeout(function(){e(".ai1wm-report-problem-dialog").removeClass("ai1wm-report-active")},2e3)}},dataType:"json",async:!1})})})},{}],7:[function(e,t,a){var a=t.exports={};a.getEl=function(e){return document.querySelector(e)}},{}],8:[function(e,t){var a=(e("./selector"),function(e){this.settings=e,this.file=null,this.storage=null,this.xhr=null,this.reader=null,this.content=null,this.retry=3,this.abort=!1});a.prototype.addFile=function(e,t){var a=this,i=t.name.split(".").pop(),o=["wpress","bin"];if(-1===o.indexOf(i)){var r="You can only upload files with wpress or bin extensions. ";return r+="If you need assistance, email support@servmask.com",alert(r),void 0}if(536870912==this.settings.ai1wm_archive_size&&t.size>536870912){var s=parseFloat(t.size/1048576).toFixed(2),r="Your file is "+s+"MB. Files over 512MB are ";return r+="supported via our Unlimited Extension. You can get it from here: ",r+="https://servmask.com/products/unlimited-extension",alert(r),void 0}this.reader=new FileReader,this.reader.addEventListener("loadend",function(e){return e.total!==e.loaded?(alert("Unable to read the file into memory"),void 0):(a.content=a.reader.result,a.settings.onFileAdded(),void 0)}),this.reader.readAsArrayBuffer(t),this.file=t,this.storage=e},a.prototype.start=function(){this.abort=!1,this.sendChunk()},a.prototype.stop=function(){this.abort=!0},a.prototype.sendChunk=function(e){e=e||!1;var t=new FormData,a=null;t.append("name",this.file.name),t.append("provider","file"),t.append("method","import"),t.append("storage",this.storage),t.append("secret_key",this.settings.secret_key),a=e===!1?this.getChunk():this.chunk,t.append("upload-file",a),this.xhr=new XMLHttpRequest,this.xhr.onreadystatechange=this.onReadyStateChange.bind(this),this.xhr.open("POST",this.settings.url,!0),this.xhr.send(t)},a.prototype.retryChunk=function(){this.sendChunk(!0)},a.prototype.getChunk=function(){var e=1024e3;return fileLength=this.content.byteLength,e>fileLength&&(e=fileLength),this.chunk=this.content.slice(0,e),this.content=this.content.slice(e),this.chunk=new Blob([this.chunk],{type:"application/octet-binary"}),this.chunk},a.prototype.hasAbort=function(){return this.abort},a.prototype.hasMoreData=function(){return this.content.byteLength>0},a.prototype.getUploadedPercent=function(){return parseFloat(100-this.content.byteLength/this.reader.result.byteLength*100).toFixed(2)},a.prototype.onReadyStateChange=function(){var e=this;if(4===e.xhr.readyState)if(200===e.xhr.status)e.retry=3,e.hasAbort()||(e.hasMoreData()?(e.settings.onChunkUploaded(e.getUploadedPercent()),e.sendChunk()):(e.settings.onChunkUploaded(e.getUploadedPercent()),e.settings.onFileUploaded(e.storage,e.file.name)));else if(0===e.retry){var t="All in One WP Migration failed to upload your file. Would you like to retry?";confirm(t)?(e.retry=3,e.retryChunk()):e.settings.onError()}else e.retry--,setTimeout(e.retryChunk.bind(e),2e3)},t.exports=a},{"./selector":7}],9:[function(e,t){var a=function(){};a.random=function(e){for(var t="",a="abcdefghijklmnopqrstuvwxyz0123456789",i=0;e>i;i++)t+=a.charAt(Math.floor(Math.random()*a.length));return t},a.getURLParameter=function(e){for(var t=window.location.search.substring(1),a=t.split("&"),i=0;i<a.length;i++){var o=a[i].split("=");if(o[0]==e)return o[1]}},t.exports=a},{}]},{},[1]);